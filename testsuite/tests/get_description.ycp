// Sysconfig module - testsuite
//
// get_description() tests
//
// testedfiles: Sysconfig.ycp
//
// $Id$
//

{

import "Testsuite";
import "Pkg";   // override packamanager
import "Sysconfig";

Testsuite::Test( ``(Sysconfig::Set([ $[ "sysconfig_key" : "VARIABLE",
    "sysconfig_path" : "/etc/sysconfig/test",
    "sysconfig_value" : "no" ] ]) ), [ $[], $[], $[] ], nil );


// test non-existing variable
Testsuite::Test( ``(Sysconfig::get_description("nonexisting$variable") ), [ $[], $[], $[] ], nil );

// test variable without metadata
map READ = $[ "syseditor" : $[ "value" : $[ "/etc/sysconfig/test" : $[ "VARIABLE" : "yes" ]],
			       "value_comment" : $[ "/etc/sysconfig/test" : $[ "VARIABLE" : "# Only comment, no metadata" ]]
			    ]
];
Testsuite::Test( ``(Sysconfig::get_description("VARIABLE$/etc/sysconfig/test") ), [ READ, $[], $[] ], nil );


// test variable with metadata
READ = $[ "syseditor" : $[ "value" : $[ "/etc/sysconfig/test" : $[ "VARIABLE" : "yes" ]],
			       "value_comment" : $[ "/etc/sysconfig/test" : $[ "VARIABLE" : "## Path: Test\n## Description: help\n## Type: yesno\n# Comment with metadata" ]]
			    ]
];
Testsuite::Test( ``(Sysconfig::get_description("VARIABLE$/etc/sysconfig/test") ), [ READ, $[], $[] ], nil );


// test multiple keywods in metadata
READ = $[ "syseditor" : $[ "value" : $[ "/etc/sysconfig/test" : $[ "VARIABLE" : "yes" ]],
			       "value_comment" : $[ "/etc/sysconfig/test" : $[ "VARIABLE" : "## Path: Test\n## Description: help\n## Type: yesno\n##Path: Second path definition\n# Comment with metadata" ]]
			    ]
];
Testsuite::Test( ``(Sysconfig::get_description("VARIABLE$/etc/sysconfig/test") ), [ READ, $[], $[] ], nil );

}

